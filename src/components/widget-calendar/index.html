<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin: 0;
      height: 100vh;
      background: #fff;
      color: #333;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
      box-sizing: border-box;
    }
    .header { font-weight: bold; margin-bottom: 10px; }
    .grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px; width: 100%; text-align: center; font-size: 0.8em; }
    .day-name { color: #888; }
    .day { padding: 4px; border-radius: 4px; }
    .today { background: #238f4a; color: white; }
  </style>
  <script src="../../renderer/lib/moment.min.js"></script>
</head>
<body>
  <div class="header" id="month-year"></div>
  <div class="grid" id="calendar"></div>
  <script>
    if (typeof moment !== 'undefined') {
      moment.locale('zh-cn');
      const now = moment();
      document.getElementById('month-year').innerText = now.format('YYYY年 MMMM');
      
      const grid = document.getElementById('calendar');
      const days = moment.weekdaysMin(); // Use moment's weekdays
      // Shift to start from Monday if needed, or stick to Sunday default. 
      // Let's use Sunday start to match previous code logic or adapt.
      // Previous code used: ['日','一'...] which is Sunday start.
      
      days.forEach(d => {
        const el = document.createElement('div');
        el.className = 'day-name';
        el.innerText = d;
        grid.appendChild(el);
      });
      
      const startOfMonth = moment(now).startOf('month');
      const endOfMonth = moment(now).endOf('month');
      const startDay = startOfMonth.day(); // 0 for Sunday
      const totalDays = endOfMonth.date();
      
      for(let i=0; i<startDay; i++) {
        grid.appendChild(document.createElement('div'));
      }
      
      for(let i=1; i<=totalDays; i++) {
        const el = document.createElement('div');
        el.className = 'day';
        el.innerText = i;
        if (i === now.date()) el.classList.add('today');
        grid.appendChild(el);
      }
    } else {
      // Fallback to original code
      const now = new Date();
      document.getElementById('month-year').innerText = now.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long' });
      
      const grid = document.getElementById('calendar');
      const days = ['日','一','二','三','四','五','六'];
      days.forEach(d => {
        const el = document.createElement('div');
        el.className = 'day-name';
        el.innerText = d;
        grid.appendChild(el);
      });
      
      const firstDay = new Date(now.getFullYear(), now.getMonth(), 1);
      const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);
      const startDay = firstDay.getDay();
      const totalDays = lastDay.getDate();
      
      for(let i=0; i<startDay; i++) {
        grid.appendChild(document.createElement('div'));
      }
      
      for(let i=1; i<=totalDays; i++) {
        const el = document.createElement('div');
        el.className = 'day';
        el.innerText = i;
        if (i === now.getDate()) el.classList.add('today');
        grid.appendChild(el);
      }
    }
  </script>
</body>
</html>
